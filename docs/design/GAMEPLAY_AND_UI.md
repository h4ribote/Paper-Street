# Core Gameplay & UI/UX

## 1. コアゲームプレイ (Core Gameplay)
プレイヤーはプロフェッショナルなトレーダーとして、以下のサイクルで資産を増やします。

1.  **情報収集 (Intel Gathering)**: ニュースフィード、企業レポート、マクロ経済指標を確認します。
2.  **分析 (Analysis)**: チャート分析、ファンダメンタルズ分析を行い、市場の動向を予測します。
3.  **取引実行 (Execution)**: 株式、債券、通貨などの売買注文を出します。信用取引やヘッジも駆使します。
4.  **ポートフォリオ管理 (Risk Management)**: リスク管理を行いながら、資産（Equity）を最大化します。


## 2. プレイヤーのモチベーションとリテンション (Motivation & Retention)
単なる「資産増加」以外の楽しみを提供し、毎日ログインしたくなる要素を実装します。

*   **Trader Rank Progression**: プレイヤーは活動量に応じてXPを獲得し、ランクアップを目指します。詳細は [Trader Rank & Progression System](./TRADER_RANK_SYSTEM.md) を参照してください。
*   **デイリーミッション**: ランクアップに必要なXPを獲得するための日次タスクです。難易度別に設定され、完遂ボーナスが存在します。


## 3. UI/UX デザイン (The Paper Street Terminal)
プロフェッショナルなトレーダーが使用する「情報端末」を再現しつつ、ゲームとしての使いやすさを両立させます。

### 3.1. 言語設定 (Localization)
UIおよびニュースコンテンツは**日本語と英語**に対応しています。
プレイヤーは設定メニューからいつでも表示言語を切り替えることが可能です。
特にニュースフィードは、選択された言語に対応したヘッドラインと本文がリアルタイムで配信されます。

### 3.2. 画面レイアウト案 (Layout)
画面全体を複数のパネル（ウィジェット）で構成し、プレイヤーが自由に配置を変更できるドッキングシステムを採用します。

1.  **Header (ステータスバー)**:
    *   **プロフィール**: プレイヤー名、**ランクアイコン (Shrimp, Whale etc.)**、**XPプログレスバー**。
    *   **資産情報**: 総資産 (Equity), 評価損益 (Unrealized P/L), 余力 (Buying Power), レバレッジ比率。
    *   **市場概況**: 全体指数（S&P 500的なもの）、ニュース速報テロップ。
2.  **Market Watch (監視リスト)**:
    *   お気に入り銘柄のリスト。現在値、変動率、ミニチャートを表示。
3.  **Chart Panel (メイン)**:
    *   多機能チャート（TradingView）。インジケーター（MA, Bollinger Bands, MACD等）の追加が可能。
    *   **Drag & Drop Order**: チャート上の価格ラインをドラッグして指値を変更する直感的な操作。
4.  **Order Entry (注文パネル)**:
    *   売買注文を行うパネル。「レバレッジスライダー」の横に、**「推定ロスカット価格 (Est. Liq Price)」** を表示します。
    *   **Execution Condition Selector**: GTC, IOC, FOK などの執行条件を選択するドロップダウンメニューを配置します。
    *   ※計算式: `Entry Price` から `75% of Margin` 分だけ逆行した価格。
5.  **Order Book & Depth (板情報)**:
    *   **Level 2 Data**: すべての指値注文を可視化。
    *   **Depth Chart**: 売り圧・買い圧のバランスを視覚的に表示。
6.  **Time & Sales (歩み値)**:
    *   約定履歴のリアルタイム表示。大口注文（Whale）は色を変えて強調表示。
7.  **Position & Orders (建玉管理)**:
    *   現在の保有ポジション一覧。各ポジションの損益率（PnL %）を表示します。
    *   **Add Margin**: ロスカット回避のために、証拠金を追加（追証）できるボタンを配置します。
    *   ここから「全決済」「ドテン売買」などのクイックアクションが可能。


## 4. プレイヤーアクション (Player Actions)
### 4.1. 注文タイプ (Order Types)
*   **Market (成行)**: 即座に約定させる注文です。市場の混乱を防ぐため、以下の保護機能（Market Protection）が適用されます。
    *   **価格制限 (Price Limit)**: 発注時の最良気配値（Best Quote）から **±5%** の範囲内でのみ約定します。
        *   買い注文: `Best Ask * 1.05` を上限価格として設定。
        *   売り注文: `Best Bid * 0.95` を下限価格として設定。
    *   **部分約定とキャンセル (Partial Fill & Cancel)**: 指定範囲内の板（Liquidity）をすべて食い尽くしても注文数量が残っている場合、**残りの数量は自動的にキャンセル**されます。不当に不利な価格での約定を防ぎます。
    *   **クールダウン (Cool-down)**: 成行注文を発注した後、**同一方向（Buy/Sell）の成行注文は5秒間受け付けられません**。
        *   ※指値注文（Limit）や決済注文（Close Position）はこの制限の対象外です。
*   **Limit (指値)**: 指定価格で待つ。流動性供給者（Maker）として手数料リベートを得られる。
    *   **FX市場における特例**: FXでは指値注文は「指定価格帯（レンジ）への集中流動性提供」として扱われます。
    *   **自動引き出し**: 市場価格が指定レンジを通過し、資産の変換が完了（指値約定）すると、システムが自動的に流動性をプールから引き出し、ウォレットに返還します。
*   **Stop / Stop Limit**: 損切りやブレイクアウト狙い。

### 4.2. 執行条件 (Execution Conditions)
注文パネルで以下の執行条件を選択可能です（デフォルトは GTC）。

*   **GTC (Good Till Cancelled)**: キャンセルされるまで有効な注文。
*   **IOC (Immediate Or Cancel)**: 即座に約定できる分だけ約定させ、残りはキャンセルする。
*   **FOK (Fill Or Kill)**: 即座に全数量が約定できる場合のみ実行し、できない場合は全量をキャンセルする（部分約定なし）。


## 5. ニュースシステム (News System)
市場価格に直接影響を与えるニュースシステムの詳細は、以下のドキュメントを参照してください。

*   [News System Detailed Design](NEWS_SYSTEM.md)
